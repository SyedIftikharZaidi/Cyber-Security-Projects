<h1>DNS Log Analysis with Splunk SIEM</h1>

<h2>Project Overview</h2>
<p>This project demonstrates how to analyze DNS logs using Splunk SIEM to monitor network activity and detect potential security threats.</p>

<h2>Prerequisites</h2>
<ul>
  <li>Splunk Enterprise installed and configured</li>
  <li>DNS logs being forwarded to Splunk</li>
  <li>Basic understanding of Splunk Search Processing Language (SPL)</li>
</ul>

<h2>Setup Instructions</h2>

<h3>1. Uploading DNS Logs to Splunk</h3>
<pre><code class="language-splunk">1. Prepare DNS log files in text format containing:
   - Source/destination IPs
   - Domain names
   - Query types
   - Response codes
   
2. In Splunk Web:
   Settings → Add Data → Upload
   Select your DNS log file
   
3. Configure settings:
   - Source Type: `dns` (or custom)
   - Index: Specify or use default
   - Host: Set if needed

4. Verify upload with:
   <span style="color:#7dcfff">index=</span><span style="color:#ff9d00">&lt;your_dns_index&gt;</span> <span style="color:#7dcfff">sourcetype=</span><span style="color:#ff9d00">&lt;your_dns_sourcetype&gt;</span>
</code></pre>

<h2>DNS Analysis Queries</h2>

<h3>Basic Queries</h3>
<h4>Count DNS queries by type</h4>
<pre><code class="language-splunk"><span style="color:#7dcfff">index=</span><span style="color:#ff9d00">&lt;dns_index&gt;</span> <span style="color:#7dcfff">sourcetype=</span><span style="color:#ff9d00">&lt;dns_sourcetype&gt;</span>
<span style="color:#7dcfff">| stats count by query_type</span>
<span style="color:#7dcfff">| sort - count</span>
</code></pre>

<h4>Top queried domains</h4>
<pre><code class="language-splunk"><span style="color:#7dcfff">index=</span><span style="color:#ff9d00">&lt;dns_index&gt;</span> 
<span style="color:#7dcfff">| top limit=20 fqdn</span>
</code></pre>

<h3>Threat Detection</h3>
<h4>Detect suspicious queries</h4>
<pre><code class="language-splunk"><span style="color:#7dcfff">index=</span><span style="color:#ff9d00">&lt;dns_index&gt;</span> 
<span style="color:#7dcfff">| regex fqdn="(exe|dll|bat|ps1)$"</span>
<span style="color:#7dcfff">| table _time, src_ip, fqdn</span>
</code></pre>

<h4>DNS tunneling indicators</h4>
<pre><code class="language-splunk"><span style="color:#7dcfff">index=</span><span style="color:#ff9d00">&lt;dns_index&gt;</span>
<span style="color:#7dcfff">| where len(fqdn) > 100</span>
<span style="color:#7dcfff">| stats count by src_ip, fqdn</span>
</code></pre>

<h2>Visualization Examples</h2>
```html
<!-- Sample visualization placeholder -->
<div style="background:#f5f5f5;padding:15px;border-radius:5px">
  <h4>DNS Query Frequency (Last 24 Hours)</h4>
  <img src="https://via.placeholder.com/600x300?text=DNS+Query+Timechart" alt="Timechart Example" style="width:100%">
</div>
